<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- <script src="./js/d3v7.js"></script> -->
    <script src="../dev/js/d3v7.js"></script>


    <script src="./js/billboard.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="./css/billboard.css">
    <link rel="stylesheet" href="./css/graph.min.css">
</head>

<body>

    <div id="risksArea">
        <label for="riskSelect">
            CVD Risk Type
            <!-- <span>Select risk type</span> -->
        </label>

        <select name="riskSelect" id="riskSelect">
            <!-- <option value="Select risk type" selected>Select risk type</option> -->
            <option value="Metabolic">Metabolic</option>
            <option value="Behavioral">Behavioral</option>
            <option value="Environmental">Environmental</option>
        </select>
        <div id="risksChart"></div>

    </div>
</body>

<script src="../data/cleaned/Risk_plot3.js"></script>
<script>
    let selectedLocation = "Andean Latin America",
        selectedRiskType = "Metabolic";

    console.log("RISKDATA 3: ", riskData3[selectedLocation][selectedRiskType])//[selectedRiskType])

    let = causeNameArr =
    {
        "Behavioral":
            ["Alcoholic cardiomyopathy", "Aortic aneurysm", "Atrial fibrillation and flutter", "Hypertensive heart disease", "Intracerebral hemorrhage", "Ischemic heart disease", "Ischemic stroke", "Lower extremity peripheral arterial disease", "Subarachnoid hemorrhage"],
        "Environmental":
            ["Alcoholic cardiomyopathy", "Aortic aneurysm", "Atrial fibrillation and flutter", "Hypertensive heart disease", "Intracerebral hemorrhage", "Ischemic heart disease", "Ischemic stroke", "Lower extremity peripheral arterial disease", "Myocarditis", "Other cardiomyopathy", "Subarachnoid hemorrhage"],
        "Metabolic":
            ["Aortic aneurysm", "Atrial fibrillation and flutter", "Hypertensive heart disease", "Intracerebral hemorrhage", "Ischemic heart disease", "Ischemic stroke", "Lower extremity peripheral arterial disease", "Subarachnoid hemorrhage"]
    }

</script>


<script>


    let createRiskBarChart = () => {
        let risksBarChart = bb.generate({
            bindto: "#risksChart",
            size: { height: 500 },
            data: {
                columns: riskData3[selectedLocation][selectedRiskType],
                type: "bar",
                groups: [causeNameArr[selectedRiskType]]
            },
            bar: {
                indices: {
                    removeNull: false
                },
                padding: 2
                // ,
                // width: {
                //     ratio: 0.9,
                //     max: 30
                // }
            },
            tooltip: {
                grouped: true
            },
            axis: {
                rotated: true,
                x: {
                    type: "category",
                    categories: causeNameArr[selectedRiskType],
                },
                y: {
                    type: "log",
                    min: -100,
                    max: 1000,
                    // multiline: true,
                },
                y2: {
                    show: false,
                    min: -1000,
                    max: 1000
                }
            },
            zoom: {
                enabled: true, // for ESM specify as: zoom()
                type: "drag"
            },
            legend: { position: "right" }
        })
    }



    createRiskBarChart()


    let riskSelect = document.getElementById("riskSelect");
    // riskSelect.addEventListener('change', (el) => window.localStorage.setItem('riskType', JSON.stringify(el.target.options[el.target.selectedIndex].text)))
    riskSelect.addEventListener('change', (el) => {
        selectedRiskType = el.target.options[el.target.selectedIndex].text
        console.log(selectedRiskType, riskData3[selectedLocation][selectedRiskType])
        createRiskBarChart()
    });

</script>

</html>